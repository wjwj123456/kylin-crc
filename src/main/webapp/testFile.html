<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
</head>
<body>

<form action="/crc/ImageServlet" method="post"
      enctype="multipart/form-data">
    <input type="file"><br/> <input type="submit">
</form>
<h3>File Upload:</h3>
Select a file to upload:
<br/>
<form action="/crc/FileServlet?type=upload" method="post"
      target="_blank" enctype="multipart/form-data" id="form">
    <input type="file" name="file" multiple size="50"/> <br/> <input
        type="submit" value="Upload File"/>
    <input id="upload" type="button" value="upload with ajax">
</form>
<a href="/crc/FileServlet?type=download">
    点击下载
</a>
<script src="js/jquery.min.js"></script>
<script>
    $(':file').change(function () {
        var file = this.files;

        for (var i = 0; i < file.length; i++) {
            console.log(file[i].name);
            console.log(file[i].size);
            console.log(file[i].type);
        }
    });
    $('#upload').click(function(){
        var formData = new FormData($('#form'));
        console.log(formData);
        $.ajax({
            url: '/crc/FileServlet?type=upload',  //server script to process data
            type: 'POST',
            xhr: function() {  // custom xhr
                myXhr = $.ajaxSettings.xhr();
                if(myXhr.upload){ // check if upload property exists
                    myXhr.upload.addEventListener('progress', function () {
                        console.log("test")
                    }, false); // for handling the progress of the upload
                }
                return myXhr;
            },
            //Ajax事件
            beforeSend: function () {
                
            },
            success: function () {
                console.log("success")
            },
            error: function () {
                console.log("error")
            },
            // Form数据
            data: formData,
            //Options to tell JQuery not to process data or worry about content-type
            cache: false,
            contentType: false,
            processData: false
        });
    });
</script>
</body>
</html>